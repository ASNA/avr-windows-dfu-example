<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Form1.vr</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>Form1.vr</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This example creates a DFU-like utility for a given file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>It first displays this screen</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p><img alt="" src="https://asna.com/media/images/screen-1-3.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Then, given a valid customer number displays this update panel</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p><img alt="" src="https://asna.com/media/images/screen-2-3.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Its intent to show some basic techniques for working with data
a fat-client Windows UI. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p><a href="https://github.com/ASNA/avr-windows-dfu-example">Download this code here</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">Using</span> <span class="nx">System</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Text</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">RegularExpressions</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span>

<span class="nx">BegClass</span> <span class="nx">Form1</span> <span class="nx">Extends</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">Form</span><span class="p">)</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span> <span class="nx">Partial</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>As a general rule, <code>/region</code> and <code>/endregion</code> obfuscate your code and 
should be avoided like Paul McCartney&rsquo;s solo music. <a href="https://docs.asna.com/documentation/Help150/AVR/_HTML/avrCompilerDirectivesRegion.htm">Read more
about collapsible regions here</a>
and <a href="https://docs.asna.com/documentation/Help150/AVR/_HTML/avrCompilerDirectivesEndRegion.htm">here</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="err">/region Default Constructor</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h3>Form constructor</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegConstructor</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Required for Windows Form Designer support</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">InitializeComponent</span><span class="p">()</span>

    <span class="nx">EndConstructor</span>

    <span class="o">/</span><span class="nx">endregion</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>The database connection and diskfiles are declared in AVR &lsquo;mainline&rsquo; code.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h4>Mainline code</h4>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">DclDB</span> <span class="nx">pgmDB</span> <span class="nx">DBName</span><span class="p">(</span><span class="s2">&quot;*Public/Cypress&quot;</span><span class="p">)</span> 
         
    <span class="nx">DclDiskFile</span> <span class="nx">CustByNumber</span> <span class="o">+</span>
          <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Update</span><span class="p">)</span> <span class="o">+</span> 
          <span class="nx">Org</span><span class="p">(</span><span class="o">*</span><span class="nx">Indexed</span><span class="p">)</span> <span class="o">+</span> 
          <span class="nx">Prefix</span><span class="p">(</span><span class="nx">Cust_</span><span class="p">)</span> <span class="o">+</span> 
          <span class="nx">File</span><span class="p">(</span><span class="s2">&quot;Examples/CMastNewL1&quot;</span><span class="p">)</span> <span class="o">+</span>
          <span class="nx">DB</span><span class="p">(</span><span class="nx">pgmDB</span><span class="p">)</span> <span class="o">+</span>
          <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">No</span><span class="p">)</span> <span class="o">+</span> 
          <span class="nx">AddRec</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Declare anything you want global to the rest of this class here. But do try to keep 
global variables to a minimum. The road to programming hell is paved with global variables.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h3>Form is loaded</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">Form1_Load</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">Load</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="o">*</span><span class="nb">Object</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">System</span><span class="p">.</span><span class="nx">EventArgs</span>

        <span class="c1">// Occurs when form is first loaded</span>
        <span class="c1">// Put form &quot;startup&quot; code here (ie open files)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Override the runtime database. You might not need/want to do 
this&ndash;but do understand that you can </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">pgmDB</span><span class="p">.</span><span class="nx">DBName</span> <span class="o">=</span> <span class="s1">&#39;*Public/Cypress&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Show connected DB name on form title bar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">Text</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nx">pgmDB</span><span class="p">.</span><span class="nx">DBName</span>

        <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Empty</span> 

        <span class="nx">Connect</span> <span class="nx">pgmDB</span> 
        <span class="nx">Open</span> <span class="nx">CustByNumber</span>        
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <h3>Form is closing</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">Form1_FormClosing</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">FormClosing</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">FormClosingEventArgs</span><span class="p">)</span>

        <span class="c1">// Occurs when form is closing    </span>
        <span class="c1">// Put form &quot;housecleaning&quot; code here (ie close files)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Close all files and disconnect the DB when this form closes.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Close</span> <span class="o">*</span><span class="nx">All</span>
        <span class="nx">Disconnect</span> <span class="nx">pgmDB</span>             
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <h3>Update record</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">btnOK_Click</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">btnOK</span><span class="p">.</span><span class="nx">Click</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Copy fields from inputs to record format fields</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">PopulateRecordFromUI</span><span class="p">()</span>
        <span class="nx">Update</span> <span class="nx">CustByNumber</span>

        <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="s1">&#39;Customer #{0} updated&#39;</span><span class="p">,</span> <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Reset UI</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">ResetUI</span><span class="p">()</span>
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <h3>Cancel record update</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">linklabelCancel_LinkClicked</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">linklabelCancel</span><span class="p">.</span><span class="nx">LinkClicked</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">LinkLabelLinkClickedEventArgs</span><span class="p">)</span>

        <span class="nx">ResetUI</span><span class="p">()</span>
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Find customer by clicking &ldquo;find&rdquo; link</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">linklabelFindCustomer_LinkClicked</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">linklabelFindCustomer</span><span class="p">.</span><span class="nx">LinkClicked</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">LinkLabelLinkClickedEventArgs</span><span class="p">)</span>

        <span class="nx">Cust_CMCustNo</span> <span class="o">=</span> <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Text</span> 
        <span class="nx">FindCustomer</span><span class="p">(</span><span class="nx">Cust_CMCustNo</span><span class="p">)</span>
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Find customer by pressing Enter key</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">maskedTextBoxCMCustNo_KeyDown</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">KeyDown</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">KeyEventArgs</span><span class="p">)</span>

        <span class="nx">ClearErrorMessage</span><span class="p">()</span>

        <span class="nx">Cust_CMCustNo</span> <span class="o">=</span> <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Text</span> 
        
        <span class="nx">If</span> <span class="nx">e</span><span class="p">.</span><span class="nx">KeyCode</span> <span class="o">=</span> <span class="nx">Keys</span><span class="p">.</span><span class="nx">Enter</span> 
            <span class="nx">e</span><span class="p">.</span><span class="nx">Handled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">SuppressKeyPress</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
            <span class="nx">FindCustomer</span><span class="p">(</span><span class="nx">Cust_CMCustNo</span><span class="p">)</span>
        <span class="nx">EndIf</span>         
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <h3>Find a customer by customer number</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegFunc</span> <span class="nx">FindCustomer</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>Return <em>True if record found
Return </em>False if record not found</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">DclSrParm</span> <span class="nx">CustomerNumber</span> <span class="nx">Like</span><span class="p">(</span><span class="nx">Cust_CMCustNo</span><span class="p">)</span> 

        <span class="nx">DclFld</span> <span class="nx">Result</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Read customer record.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Chain</span> <span class="nx">CustByNumber</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">Cust_CMCustNo</span><span class="p">)</span> 
        <span class="nx">If</span> <span class="nx">CustByNumber</span><span class="p">.</span><span class="nx">IsFound</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>If customer found</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">panelCustomerNumber</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
            <span class="nx">panelDataForm</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
            <span class="nx">PopulateUIFromRecord</span><span class="p">()</span>
            <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>If customer not found</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="s1">&#39;Customer #{0} not found&#39;</span><span class="p">,</span> <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span>
            <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Focus</span><span class="p">()</span>
            <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">SelectAll</span><span class="p">()</span>
            <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span> 
        <span class="nx">EndIf</span> 
    <span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <h3>Copy fields from inputs fields to record format fields</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">PopulateRecordFromUI</span>
        <span class="nx">Cust_CMName</span>     <span class="o">=</span> <span class="nx">txtCMName</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">Cust_CMAddr1</span>    <span class="o">=</span> <span class="nx">txtCMAddr1</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">Cust_CMCity</span>     <span class="o">=</span> <span class="nx">txtCMCity</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">Cust_CMState</span>    <span class="o">=</span> <span class="nx">txtCMState</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">Cust_CMPostCode</span> <span class="o">=</span> <span class="nx">txtCMPostCode</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>CMFax is numeric so RemoveNonNumericCharacters removes 
any non-numeric characters before saving the value</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Cust_CMFax</span>      <span class="o">=</span> <span class="nx">RemoveNonNumericCharacters</span><span class="p">(</span><span class="nx">txtCMFax</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span>
        <span class="nx">Cust_CMPhone</span>    <span class="o">=</span> <span class="nx">txtCMPhone</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <h3>Copy fields record format fields to input fields</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">PopulateUIFromRecord</span>
        <span class="nx">txtCMName</span><span class="p">.</span><span class="nx">Text</span>     <span class="o">=</span> <span class="nx">Cust_CMName</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">txtCMAddr1</span><span class="p">.</span><span class="nx">Text</span>    <span class="o">=</span> <span class="nx">Cust_CMAddr1</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">txtCMCity</span><span class="p">.</span><span class="nx">Text</span>     <span class="o">=</span> <span class="nx">Cust_CMCity</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">txtCMState</span><span class="p">.</span><span class="nx">Text</span>    <span class="o">=</span> <span class="nx">Cust_CMState</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
        <span class="nx">txtCMPostCode</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">Cust_CMPostCode</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Input fields in .NET Windows forms apps are always text. They need to be 
converted to and from source and target values. Cust_CMFax is a numeric value.
The .NET&rsquo;s ToString() method used to format the numeric value to a desired
string format. <a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/custom-numeric-format-strings">Read about .NET&rsquo;s custom numeric format strings here</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">txtCMFax</span><span class="p">.</span><span class="nx">Text</span>      <span class="o">=</span> <span class="nx">Cust_CMFax</span><span class="p">.</span><span class="nx">ToString</span><span class="p">(</span><span class="s2">&quot;(000) 000-0000&quot;</span><span class="p">)</span> 
        <span class="nx">txtCMPhone</span><span class="p">.</span><span class="nx">Text</span>    <span class="o">=</span> <span class="nx">Cust_CMPhone</span><span class="p">.</span><span class="nx">Trim</span><span class="p">()</span>
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <h3>Hide data input panel</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">ResetUI</span>
        <span class="nx">panelDataForm</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span> 
        <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Empty</span> 
        <span class="nx">maskedTextBoxCMCustNo</span><span class="p">.</span><span class="nx">Focus</span><span class="p">()</span>
        <span class="nx">panelCustomerNumber</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <h3>Clear error message</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegSr</span> <span class="nx">ClearErrorMessage</span>
        <span class="nx">labelMessage</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Empty</span> 
    <span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <h3>Remove non-numeric characters from a string</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">BegFunc</span> <span class="nx">RemoveNonNumericCharacters</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Use a regular expression to remove all non-numeric characters
from an input string. <a href="https://asna.com/us/tech/kb/series/learning-regex/regex-intro">Read more about regular expressions here</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">DclSrParm</span> <span class="nx">Value</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>[^0-9] is the regular expression that searches a string
for all occurrences of non-numeric values</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">LeaveSr</span> <span class="nx">Regex</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">Value</span><span class="p">,</span> <span class="s2">&quot;[^0-9]&quot;</span><span class="p">,</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Empty</span><span class="p">)</span>     
    <span class="nx">EndFunc</span>        
       
<span class="nx">EndClass</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
